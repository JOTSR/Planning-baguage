var c=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;var o=(t,s)=>{var i={};for(var e in t)p.call(t,e)&&s.indexOf(e)<0&&(i[e]=t[e]);if(t!=null&&c)for(var e of c(t))s.indexOf(e)<0&&d.call(t,e)&&(i[e]=t[e]);return i};var n="1.6.0";var r=`static-cache-v${n}`,l=`runtime-cache-v${n}`,h=["/","/account","/info","/invite","/style.css"],u=[/\/assets\//,/\/tabler-icons\//,/.*\.json/];self.addEventListener("install",t=>{t.waitUntil((async()=>{await(await caches.open(r)).addAll(h),self.skipWaiting()})())});self.addEventListener("activate",t=>{let s=[r,l];t.waitUntil((async()=>{let e=(await caches.keys()).filter(a=>!s.includes(a));await Promise.all(e.map(a=>caches.delete(a))),self.clients.claim()})())});self.addEventListener("fetch",t=>{let s=new URL(t.request.url);s.origin===self.location.origin&&(!u.some(i=>s.pathname.match(i))||t.respondWith((async()=>{let i=await caches.match(t.request),e=await caches.open(l);try{let a=await fetch(t.request);return await e.put(t.request,a.clone()),a}catch{if(i)return i}return new Response("Ressource indisponible",{status:503})})()))});self.addEventListener("notificationclick",t=>{let s=t.action,[i,e,a]=s.match(/(.+)_(.+)#(.+)/);i==="claim"&&((e==="accept"||e==="reject")&&self.clients.openWindow(`${self.location.hostname}/api/webpush_actions/claim?uuid=${a}&action=${e}`),e==="contact"&&self.clients.openWindow(`mailto:${a}`)),i==="calendar"&&e==="add"&&self.clients.openWindow(`${self.location.hostname}/api/webpush_actions/calendar?uuid=${a}`)});self.addEventListener("push",async t=>{if(Notification?.permission!=="granted")return;let e=t.data?.json(),{title:s}=e,i=o(e,["title"]);await m(s,i)});async function m(t,{icon:s,body:i,tag:e,actions:a}){if(!["denied","granted"].includes(Notification.permission))try{await Notification.requestPermission()}catch(f){return f}self.registration.showNotification(t,{lang:"fr",badge:"/assets/icons/logo-maskable-512.png",icon:s,body:i,actions:a,tag:e})}
//!cache strategy : network first
