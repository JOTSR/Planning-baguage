var c=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;var o=(t,a)=>{var i={};for(var e in t)p.call(t,e)&&a.indexOf(e)<0&&(i[e]=t[e]);if(t!=null&&c)for(var e of c(t))a.indexOf(e)<0&&d.call(t,e)&&(i[e]=t[e]);return i};var n="1.5.2";var r=`static-cache-v${n}`,l=`runtime-cache-v${n}`,h=["/","/account","/info","/invite","/style.css"],u=[/\/assets\//,/\/tabler-icons\//,/.*\.json/];self.addEventListener("install",t=>{t.waitUntil((async()=>{await(await caches.open(r)).addAll(h),self.skipWaiting()})())});self.addEventListener("activate",t=>{let a=[r,l];t.waitUntil((async()=>{let e=(await caches.keys()).filter(s=>!a.includes(s));await Promise.all(e.map(s=>caches.delete(s))),self.clients.claim()})())});self.addEventListener("fetch",t=>{let a=new URL(t.request.url);a.origin===self.location.origin&&(!u.some(i=>a.pathname.match(i))||t.respondWith((async()=>{let i=await caches.match(t.request),e=await caches.open(l);try{let s=await fetch(t.request);return await e.put(t.request,s.clone()),s}catch{if(i)return i}return new Response("Ressource indisponible",{status:503})})()))});self.addEventListener("notificationclick",t=>{let a=t.action,[i,e,s]=a.match(/(.+)_(.+)#(.+)/);i==="claim"&&((e==="accept"||e==="reject")&&self.clients.openWindow(`${self.location.hostname}/api/webpush_actions/claim?uuid=${s}&action=${e}`),e==="contact"&&self.clients.openWindow(`mailto:${s}`)),i==="calendar"&&e==="add"&&self.clients.openWindow(`${self.location.hostname}/api/webpush_actions/calendar?uuid=${s}`)});self.addEventListener("push",async t=>{if(Notification?.permission!=="granted")return;let e=t.data?.json(),{title:a}=e,i=o(e,["title"]);await m(a,i)});async function m(t,{icon:a,body:i,tag:e,actions:s}){if(!["denied","granted"].includes(Notification.permission))try{await Notification.requestPermission()}catch(f){return f}self.registration.showNotification(t,{lang:"fr",badge:"/assets/icons/logo-maskable-512.png",icon:a,body:i,actions:s,tag:e})}
//!cache strategy : network first
